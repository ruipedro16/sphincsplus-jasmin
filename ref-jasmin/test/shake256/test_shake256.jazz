//param int TEST_SHAKE256_OUT = 32;
//param int TEST_SHAKE256_IN = 64;

from Sphincs require "fips202/shake256.jtmpl"

export fn test_shake256(reg u64 _out _in)
{
  stack u8[TEST_SHAKE256_OUT] out;
  stack u8[TEST_SHAKE256_IN] in;
  reg ptr u8[TEST_SHAKE256_OUT] out_p;
  reg ptr u8[TEST_SHAKE256_IN] in_p;

  reg u8 t;
  reg u64 i;

  i = 0;
  while(i < TEST_SHAKE256_IN)
  { t = (u8)[_in + i];
    in[(int)i] = t;
    i += 1;
  }

  out_p = out;
  in_p = in;

  out_p = __shake256<TEST_SHAKE256_OUT,TEST_SHAKE256_IN>(out_p, in_p);

  out = out_p;

  i = 0;
  while(i < TEST_SHAKE256_OUT)
  { t = out[(int)i];
    (u8)[_out + i] = t;
    i += 1;
  }
}

